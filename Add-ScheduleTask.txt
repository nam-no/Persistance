function Add-TaskSchedule {
    param (
        [string]$TaskName,
        [string]$ActionArg,
        [string]$Argument =" ",
        [string]$TriggerTime
        
    )
    if($Argument -eq " "){
    # Tạo Action
        $action = New-ScheduledTaskAction -Execute $ActionArg 
    }else{
        $action = New-ScheduledTaskAction -Execute $ActionArg -Argument $Argument
    }


    # Tạo Trigger
    $trigger = New-ScheduledTaskTrigger -Daily -At $TriggerTime

    # Tạo Task Schedule
    Register-ScheduledTask -TaskName $TaskName -Action $action -Trigger $trigger
}
function Check-TaskSchedule{
    param (
    [string]$TaskName
    )
    $task = Get-ScheduledTask -TaskName $TaskName -ErrorAction SilentlyContinue
    if (-not $task) {
        return 0
    
    }else{
        return 1
    }
}

#C:\Windows\System32\notepad.exe
#-Execute : C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe


[string]$taskName = Read-Host -Prompt "Enter the task name"
while((Check-TaskSchedule -TaskName $taskName) -eq 1){
    Write-Host "Task $taskName already exits."
   [string]$taskName = Read-Host -Prompt "Enter the task name again."
}
[string]$action = Read-Host -Prompt "[+] Enter the action (excutable path)"
[string]$chose = Read-Host -Prompt "[+] Do you want to enter argument (y/n)"
if($chose -eq "y"){
[string]$argument = Read-Host -Prompt "[+] Enter the Argument (optional)"
}else{
    $argument=" "
}
[string]$triggertime = Read-Host -Prompt "[+] Enter the Trigger Time (e.g., 12:00PM)"
Add-TaskSchedule -TaskName $taskName -ActionArg $action -Argument $argument -TriggerTime $triggertime

#Add-TaskSchedule -TaskName "MyTask" -ActionArg "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -Argument "C:\Windows\System32\notepad.exe" -TriggerTime "9:34AM"
#2h ngay trong tuan
$trigger = New-ScheduledTaskTrigger -Weekly -DaysOfWeek Saturday -At "2:00PM"
# 1 lan duy nhat 
$trigger = New-ScheduledTaskTrigger -Once -At "2:00PM" -OnceDate "2024-08-15"
# $trigger = New-ScheduledTaskTrigger -Monthly -DaysOfMonth 15 -At "2:00PM"